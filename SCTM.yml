sctm:

  # template of the data structure
  # <project name>:
    # <control ref>:
      # name: <control name>
      # type: <control type>
      # implementation: 
        # <dictionary containing implementation details>
      # source_ref: <list of source references>
    # <control ref>:
      # name: <control name>
      # type: <control type>
      # implementation: 
        # <dictionary containing implementation details>
      # source_ref: <list of source references>

  AMIgen:
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>

  ash-linux-formula:
    'AC-7':
      name: 'UNSUCCESSFUL LOGON ATTEMPTS'
      type: 'Common'
      implementation:
        'Modify "/etc/pam.d/system-auth-ac" and "/etc/pam.d/password-auth-ac" to enforce':
          - 'auth required pam_faillock.so preauth silent audit deny=3 unlock_time=900'
          - 'auth [default=die] pam_faillock.so authfail deny=3 unlock_time=900 fail_interval=900'
          - 'auth required pam_faillock.so authsucc deny=3 unlock_time=900 fail_interval=900'
      source_ref:
        - 'Specified values are proscribed by CNSSI 1253.'
    'AC-8':
      name: 'SYSTEM USE NOTIFICATION'
      type: 'Common'
      implementation:
        'Ensure "/etc/issue" contains':
          - '<Required consent banner and user agreement>'
        'Ensure "/etc/ssh/sshd_config" contains':
          - 'Banner /etc/issue'
        'If ftp services are installed, ensure they are configured with':
          - '<banner config reflects the contents of /etc/issue>'
          - '<ash-linux has banner config settings for proftpd, pure-ftpd, and vsftpd packages>'
        'If package "gdm" is installed, ensure it is configured with':
          - 'banner_message_enable true'
          - 'banner_message_text contains the contents of /etc/issue'
      source_ref:
        - 'Content of the banner text is proscribed by DISA STIG and JTF-GNO CTO 08-008A and DoD CIO
          Memo, "Policy on Use of Department of Defense (DoD) Information Systems Standard Consent
          Banner and User Agreement," dated 9 May 2008.'
    'AC-9':
      name: 'PREVIOUS LOGON (ACCESS) NOTIFICATION'
      type: 'Common'
      implementation:
        'Ensure "/etc/ssh/sshd_config" contains':
          - 'PrintLastLog yes'
      source_ref:
        - 'Value is proscribed by DISA STIG.'
    'AC-10':
      name: 'CONCURRENT SESSION CONTROL'
      type: 'Common'
      implementation:
        'Ensure "/etc/security/limits.conf" contains':
          - '*	hard	maxlogins	10'
      source_ref:
        - 'Value is proscribed by DISA STIG.'
    'AC-11':
      name: 'SESSION LOCK'
      type: 'Common'
      implementation:
        'Ensure the package "screen" is installed':
          - 'yum install screen'
        'If the package "gdm" is installed, enforce the settings':
          - '/apps/gnome-screensaver/idle_delay 15'
          - '/apps/gnome-screensaver/idle_activation_enabled true'
          - '/apps/gnome-screensaver/lock_enabled true'
          - '/apps/gnome_settings_daemon/keybindings/screensaver "l"'
      source_ref:
        - 'Settings are proscribed by DISA STIG.'
    'AC-11(1)':
      name: 'SESSION LOCK | PATTERN-HIDING DISPLAYS'
      type: 'Common'
      implementation:
        'If the package "gdm" is installed, enforce the setting':
          - '/apps/gnome-screensaver/mode blank-only'
      source_ref:
        - 'Setting is proscribed by DISA STIG.'
    'AC-17(1)':
      name: 'REMOTE ACCESS | AUTOMATED MONITORING / CONTROL'
      type: 'Common'
      implementation: 
        'Ensure the "auditd" service is enabled and running':
          - 'chkconfig auditd on'
          - 'service auditd start'
      source_ref:
        - 'Setting is proscribed by DISA STIG.'
    'AC-17(2)':
      name: 'REMOTE ACCESS | PROTECTION OF CONFIDENTIALITY / INTEGRITY USING ENCRYPTION'
      type: 'Common'
      implementation: 
        'Ensure the service "rsh" is disabled':
          - 'chkconfig rsh off'
        'Ensure the service "rexec" is disabled':
          - 'chkconfig rexec off'
        'If the package "pam_ldap" is installed, ensure "/etc/pam_ldap.conf" contains':
          - 'ssl start_tls'
      source_ref:
        - 'Setting is proscribed by DISA STIG.'
    'AU-3':
      name: 'CONTENT OF AUDIT RECORDS'
      type: 'Common'
        'Ensure the "auditd" service is enabled and running':
          - 'chkconfig auditd on'
          - 'service auditd start'
        'If package "vsftpd" is installed, ensure "/etc/vsftpd/vsftpd.conf" contains':
          - 'xferlog_enable=YES'
          - 'xferlog_std_format=NO'
          - 'log_ftp_protocol=YES'
      source_ref:
        - 'Setting is proscribed by DISA STIG.'
    'AU-5':
      name: 'RESPONSE TO AUDIT PROCESSING FAILURES'
      type: 'Common'
      implementation: 
        'Ensure "/etc/audit/auditd.conf" contains':
          - 'action_mail_acct = root'
          - 'disk_full_action = HALT'
          - 'disk_error_action = HALT'
      source_ref:
        - 'Setting is proscribed by DISA STIG.'
    'AU-9':
      name: 'PROTECTION OF AUDIT INFORMATION'
      type: 'Common'
      implementation: 
        'Execute the commands':
          - 'rpm --setperms audit'
          - 'rpm --setugids audit'
          - 'chmod 0640 /var/log/audit/*'
          - 'chown root /var/log/audit/*'
          - 'chmod 0700 /var/log/audit'
      source_ref:
        - 'Setting is proscribed by DISA STIG.'
    'AU-9(3)':
      name: 'PROTECTION OF AUDIT INFORMATION | CRYPTOGRAPHIC PROTECTION'
      type: 'Common'
      implementation: 
        'Execute the command':
          - 'rpm -V audit | awk \'$1 ~ /..5/ && $2 != "c"\''
      source_ref:
        - 'Setting is proscribed by DISA STIG.'
    'AU-12':
      name: 'AUDIT GENERATION'
      type: 'Common'
      implementation: 
        'Ensure "/etc/audit/audit.rules" contains':
          - 'audit_time_rules-a always,exit -F arch=b64 -S adjtimex -k audit_time_rules'
          - 'audit_time_rules-a always,exit -F arch=b64 -S settimeofday -k audit_time_rules'
          - 'audit_time_rules-a always,exit -F arch=b64 -S clock_settime -k audit_time_rules'
          - '-w /etc/localtime -p wa -k audit_time_rules'
          - '-w /etc/sudoers -p wa -k actions'
          - '-w /sbin/insmod -p x -k modules'
          - '-w /sbin/rmmod -p x -k modules'
          - '-w /sbin/modprobe -p x -k modules
          - '-a always,exit -F arch=b64 -S init_module -S delete_module -k modules'
          - '-a always,exit -F arch=b32 -S chmod -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b32 -S chmod -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b64 -S chmod -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b64 -S chmod -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b32 -S fchmod -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b32 -S fchmod -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b64 -S fchmod -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b64 -S fchmod -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b32 -S fchmodat -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b32 -S fchmodat -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b64 -S fchmodat -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b64 -S fchmodat -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b32 -S fchown -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b32 -S fchown -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b64 -S fchown -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b64 -S fchown -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b32 -S fchownat -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b32 -S fchownat -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b64 -S fchownat -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b64 -S fchownat -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b32 -S fremovexattr -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b32 -S fremovexattr -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b32 -S fsetxattr -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b32 -S fsetxattr -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b32 -S lchown -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b32 -S lchown -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b32 -S lremovexattr -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b32 -S lremovexattr -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b64 -S lremovexattr -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b64 -S lremovexattr -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b32 -S lsetxattr -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b32 -S lsetxattr -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b32 -S removexattr -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b32 -S removexattr -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b32 -S setxattr -F auid>=500 -F auid!=4294967295 -k perm_mod'
          - '-a always,exit -F arch=b32 -S setxattr -F auid=0 -k perm_mod'
          - '-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid>=500 -F auid!=4294967295 -k access'
          - '-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid>=500 -F auid!=4294967295 -k access'
          - '-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid=0 -k access'
          - '-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid=0 -k access'
          - '-a always,exit -F arch=b64 -S mount -F auid>=500 -F auid!=4294967295 -k export'
          - '-a always,exit -F arch=b64 -S mount -F auid=0 -k export'
          - '-a always,exit -F arch=b64 -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid>=500 -F auid!=4294967295 -k delete'
          - '-a always,exit -F arch=b64 -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid=0 -k delete'
        'Ensure the "kernel" entry in "/etc/grub.conf" contains':
          - 'audit=1'
      source_ref:
        - 'Settings are proscribed by DISA STIG.'
    'CM-5(6)':
      name: 'ACCESS RESTRICTIONS FOR CHANGE | LIMIT PRODUCTION / OPERATIONAL PRIVILEGES'
      type: 'Hybrid'
      implementation: 
        'Execute the commands':
          - 'chmod go-w /lib/*'
          - 'chmod go-w /lib64/*'
          - 'chmod go-w /usr/lib/*'
          - 'chmod go-w /usr/lib64/*'
          - 'chmod go-w /bin/*'
          - 'chmod go-w /usr/bin/*'
          - 'chmod go-w /usr/local/bin/*'
          - 'chmod go-w /sbin/*'
          - 'chmod go-w /usr/sbin/*'
          - 'chmod go-w /usr/local/sbin/*'
          - 'chown root /lib/*'
          - 'chown root /lib64/*'
          - 'chown root /usr/lib/*'
          - 'chown root /usr/lib64/*'
          - 'chown root /bin/*'
          - 'chown root /usr/bin/*'
          - 'chown root /usr/local/bin/*'
          - 'chown root /sbin/*'
          - 'chown root /usr/sbin/*'
          - 'chown root /usr/local/sbin/*'
      source_ref:
        - 'Settings are proscribed by DISA STIG.'
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>

  ash-windows-formula:
    'AC-7':
      name: 'UNSUCCESSFUL LOGON ATTEMPTS'
      type: 'Common'
      implementation:
        'Use local security policy to enforce':
          - 'LockoutBadCount = 3'
          - 'ResetLockoutCount = 15'
          - 'LockoutDuration = 15'
      source_ref:
        - 'Values are proscribed by CNSSI 1253.'
    'AC-8':
      name: 'SYSTEM USE NOTIFICATION'
      type: 'Common'
      implementation:
        'Use local security policy to enforce':
          - 'LegalNoticeText = <Required consent banner and user agreement>'
      source_ref:
        - 'Banner text is proscribed by DISA STIG and JTF-GNO CTO 08-008A and DoD CIO Memo, "Policy
          on Use of Department of Defense (DoD) Information Systems Standard Consent Banner and User
          Agreement," dated 9 May 2008.'
    'AC-10':
      name: 'CONCURRENT SESSION CONTROL'
      type: 'Common'
      implementation:
        'Use local security policy to enforce':
          - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\fSingleSessionPerUser = 1'
      source_ref:
        - 'Value is proscribed by DISA STIG.'
    'AC-11':
      name: 'SESSION LOCK'
      type: 'Common'
      implementation:
        'Use local security policy to enforce':
          - 'HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\ScreenSaverGracePeriod = 5'
          - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\InactivityTimeoutSecs = 900'
          - 'HKCU\Software\Policies\Microsoft\Windows\Control Panel\Desktop\ScreenSaveActive = 1'
          - 'HKCU\Software\Policies\Microsoft\Windows\Control Panel\Desktop\ScreenSaverIsSecure = 1'
      source_ref:
        - 'Values are proscribed by DISA STIG.'
    'AC-11(1)':
      name: 'SESSION LOCK | PATTERN-HIDING DISPLAYS'
      type: 'Common'
      implementation:
        'Use local security policy to enforce':
          - 'HKCU\Software\Policies\Microsoft\Windows\Control Panel\Desktop\SCRNSAVE.EXE = scrnsave.scr'
      source_ref:
        - 'Setting is proscribed by DISA STIG.'
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>

  EnterpriseLayer-HBSS-formula:
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>

  EnterpriseLayer-Splunk-formula:
    'AU-9(2)':
      name: 'PROTECTION OF AUDIT INFORMATION | AUDIT BACKUP ON SEPARATE PHYSICAL SYSTEMS / COMPONENTS'
      type: 'Common'
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>
    'AU-12':
      name: 'AUDIT GENERATION'
      type: 'Common'
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>

  join-domain-formula:
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>

  systemprep-formula:
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>

  mcafee-agent-windows-formula:
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>

  splunkforwarder-windows-formula:
    'AU-9(2)':
      name: 'PROTECTION OF AUDIT INFORMATION | AUDIT BACKUP ON SEPARATE PHYSICAL SYSTEMS / COMPONENTS'
      type: 'Common'
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>
    'AU-12':
      name: 'AUDIT GENERATION'
      type: 'Common'
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>

  windows-update-agent-formula:
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>

  netbanner-formula:
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>

  emet-formula:
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>

  dotnet4-formula:
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>

  ntp-client-windows-formula:
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>
    <control ref>:
      name: <control name>
      type: <control type>
      implementation: 
        <dictionary containing implementation details>
      source_ref: <list of source references>

