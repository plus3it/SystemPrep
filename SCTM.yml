# version: <string, version of the sctm>
# datamodel: <string, version of the data model>
# projects: <dictionary of projects>
  # <project name>:
    # targets: <list of target OS or application versions for the project as a whole>
    # controls:
      # <control ref>:
        # name: <control name>
        # type: <control type>
        # source_ref: <list of common source references for the configuration>
        # implementation: <list of dictionaries containing implementation details>
          # - action: <string describing the configuration being applied>
            # parameters: <list of parameters to apply to the action>
            # targets: <optional list of targets for this specific configuration, overrides control targets>
            # source_ref: <optional list of source reference overrides for the configuration>
          # - action: <string describing the configuration being applied>
            # parameters: <list of parameters to apply to the action>
            # targets: <optional list of targets for this specific configuration, overrides control targets>
            # source_ref: <optional list of source reference overrides for the configuration>
      # <control ref>:
        # name: <control name>
        # type: <control type>
        # source_ref: <list of common source references for the configuration>
        # implementation: <list of dictionaries containing implementation details>
          # - action: <string describing the configuration being applied>
            # parameters: <list of parameters to apply to the action>
            # targets: <optional list of targets for this specific configuration, overrides control targets>
            # source_ref: <optional list of source reference overrides for the configuration>
          # - action: <string describing the configuration being applied>
            # parameters: <list of parameters to apply to the action>
            # targets: <optional list of targets for this specific configuration, overrides control targets>
            # source_ref: <optional list of source reference overrides for the configuration>

  # <project name>:
    # targets: <list of target OS or application versions for the project as a whole>
    # controls:
      # <control ref>:
        # name: <control name>
        # type: <control type>
        # source_ref: <list of common source references for the configuration>
        # implementation: <list of dictionaries containing implementation details>
          # - action: <string describing the configuration being applied>
            # parameters: <list of parameters to apply to the action>
            # targets: <optional list of targets for this specific configuration, overrides control targets>
            # source_ref: <optional list of source reference overrides for the configuration>
          # - action: <string describing the configuration being applied>
            # parameters: <list of parameters to apply to the action>
            # targets: <optional list of targets for this specific configuration, overrides control targets>
            # source_ref: <optional list of source reference overrides for the configuration>
      # <control ref>:
        # name: <control name>
        # type: <control type>
        # source_ref: <list of common source references for the configuration>
        # implementation: <list of dictionaries containing implementation details>
          # - action: <string describing the configuration being applied>
            # parameters: <list of parameters to apply to the action>
            # targets: <optional list of targets for this specific configuration, overrides control targets>
            # source_ref: <optional list of source reference overrides for the configuration>
          # - action: <string describing the configuration being applied>
            # parameters: <list of parameters to apply to the action>
            # targets: <optional list of targets for this specific configuration, overrides control targets>
            # source_ref: <optional list of source reference overrides for the configuration>

version: 'hydrogen'
datamodel: '2015-10-27'
projects:
  AMIgen:
    targets:
      - 'Enterprise Linux 6'
    controls:
      'CM-6':
        name: 'CONFIGURATION SETTINGS'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Configure "/tmp" to be on its own partition'
          - action: 'Configure "/var" to be on its own partition'
          - action: 'Configure "/var/log" to be on its own partition'
          - action: 'Configure "/var/log/audit" to be on its own partition'
          - action: 'Configure "/home" to be on its own partition'

  ash-linux-formula:
    targets:
      - 'Enterprise Linux 6'
    controls:
      'AC-6(8)':
        name: 'LEAST PRIVILEGE | PRIVILEGE LEVELS FOR CODE EXECUTION'
        type: 'Common'
        source_ref: 'NIST 800-53 rev 4'
        implementation:
          - action: 'Native feature of the target OS'
      'AC-6(9)':
        name: 'LEAST PRIVILEGE | AUDITING USE OF PRIVILEGED FUNCTIONS'
        type: 'Common'
        source_ref: 'NIST 800-53 rev 4'
        implementation:
          - action: 'Native feature of the target OS'
            parameters:
              - 'Privileged functions require the use of `sudo` and all `sudo`
                actions are logged'
      'AC-6(10)':
        name: 'LEAST PRIVILEGE | PROHIBIT NON-PRIVILEGED USERS FROM EXECUTING PRIVILEGED FUNCTIONS'
        type: 'Common'
        source_ref: 'NIST 800-53 rev 4'
        implementation:
          - action: 'Native feature of the target OS'
            parameters:
              - 'Non-privileged users are prevented from executing privileged functions'
      'AC-7':
        name: 'UNSUCCESSFUL LOGON ATTEMPTS'
        type: 'Common'
        source_ref:
          - 'Specified values are proscribed by CNSSI 1253.'
        implementation:
          - action: 'Modify "/etc/pam.d/system-auth-ac" and "/etc/pam.d/password-auth-ac" to enforce'
            parameters:
              - 'auth required pam_faillock.so preauth silent audit deny=3 unlock_time=900'
              - 'auth [default=die] pam_faillock.so authfail deny=3 unlock_time=900 fail_interval=900'
              - 'auth required pam_faillock.so authsucc deny=3 unlock_time=900 fail_interval=900'
      'AC-8':
        name: 'SYSTEM USE NOTIFICATION'
        type: 'Common'
        source_ref:
          - 'Content of the banner text is proscribed by DISA STIG and JTF-GNO CTO 08-008A and DoD CIO
            Memo, "Policy on Use of Department of Defense (DoD) Information Systems Standard Consent
            Banner and User Agreement," dated 9 May 2008.'
        implementation:
          - action: 'Ensure "/etc/issue" contains'
            parameters:
              - '<Required consent banner and user agreement>'
          - action: 'Ensure "/etc/ssh/sshd_config" contains'
            parameters:
              - 'Banner /etc/issue'
          - action: 'If ftp services are installed, ensure they are configured with'
            parameters:
              - '<banner config reflects the contents of /etc/issue>'
              - '<ash-linux has banner config settings for proftpd, pure-ftpd, and vsftpd packages>'
          - action: 'If package "gdm" is installed, ensure it is configured with'
            parameters:
              - 'banner_message_enable true'
              - 'banner_message_text contains the contents of /etc/issue'
      'AC-9':
        name: 'PREVIOUS LOGON (ACCESS) NOTIFICATION'
        type: 'Common'
        source_ref:
          - 'Value is proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure "/etc/ssh/sshd_config" contains'
            parameters:
              - 'PrintLastLog yes'
      'AC-10':
        name: 'CONCURRENT SESSION CONTROL'
        type: 'Common'
        source_ref:
          - 'Value is proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure "/etc/security/limits.conf" contains'
            parameters:
              - '*	hard	maxlogins	10'
      'AC-11':
        name: 'SESSION LOCK'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure the package "screen" is installed'
            parameters:
              - 'yum install screen'
          - action: 'If the package "gdm" is installed, enforce the settings'
            parameters:
              - '/apps/gnome-screensaver/idle_delay 15'
              - '/apps/gnome-screensaver/idle_activation_enabled true'
              - '/apps/gnome-screensaver/lock_enabled true'
              - '/apps/gnome_settings_daemon/keybindings/screensaver "l"'
      'AC-11(1)':
        name: 'SESSION LOCK | PATTERN-HIDING DISPLAYS'
        type: 'Common'
        source_ref:
          - 'Setting is proscribed by DISA STIG.'
        implementation:
          - action: 'If the package "gdm" is installed, enforce the setting'
            parameters:
              - '/apps/gnome-screensaver/mode blank-only'
      'AC-12':
        name: 'SESSION TERMINATION'
        type: 'Common'
        source_ref: 
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Ensure "/etc/ssh/sshd_config" contains the settings'
            parameters:
              - 'ClientAliveInterval 900'
      'AC-17(1)':
        name: 'REMOTE ACCESS | AUTOMATED MONITORING / CONTROL'
        type: 'Common'
        source_ref:
          - 'Setting is proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure the "auditd" service is enabled and running'
            parameters:
              - 'chkconfig auditd on'
              - 'service auditd start'
      'AC-17(2)':
        name: 'REMOTE ACCESS | PROTECTION OF CONFIDENTIALITY / INTEGRITY USING ENCRYPTION'
        type: 'Common'
        source_ref:
          - 'Setting is proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure the service "rsh" is disabled'
            parameters:
              - 'chkconfig rsh off'
          - action: 'Ensure the service "rexec" is disabled'
            parameters:
              - 'chkconfig rexec off'
          - action: 'If the package "pam_ldap" is installed, ensure "/etc/pam_ldap.conf" contains'
            parameters:
              - 'ssl start_tls'
      'AU-3':
        name: 'CONTENT OF AUDIT RECORDS'
        type: 'Common'
        source_ref:
          - 'Setting is proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure the "auditd" service is enabled and running'
            parameters:
              - 'chkconfig auditd on'
              - 'service auditd start'
          - action: 'If package "vsftpd" is installed, ensure "/etc/vsftpd/vsftpd.conf" contains'
            parameters:
              - 'xferlog_enable=YES'
              - 'xferlog_std_format=NO'
              - 'log_ftp_protocol=YES'
      'AU-5':
        name: 'RESPONSE TO AUDIT PROCESSING FAILURES'
        type: 'Common'
        source_ref:
          - 'Setting is proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure "/etc/audit/auditd.conf" contains'
            parameters:
              - 'action_mail_acct = root'
              - 'disk_full_action = HALT'
              - 'disk_error_action = HALT'
      'AU-8':
        name: 'TIME STAMPS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'No action required; Operating System provides this capability by default'
      'AU-9':
        name: 'PROTECTION OF AUDIT INFORMATION'
        type: 'Common'
        source_ref:
          - 'Setting is proscribed by DISA STIG.'
        implementation:
          - action: 'Execute the commands'
            parameters:
              - 'rpm --setperms audit'
              - 'rpm --setugids audit'
              - 'chmod 0640 /var/log/audit/*'
              - 'chown root /var/log/audit/*'
              - 'chmod 0700 /var/log/audit'
      'AU-9(3)':
        name: 'PROTECTION OF AUDIT INFORMATION | CRYPTOGRAPHIC PROTECTION'
        type: 'Common'
        source_ref:
          - 'Setting is proscribed by DISA STIG.'
        implementation:
          - action: 'Execute the command'
            parameters:
              - 'rpm -V audit | awk ''$1 ~ /..5/ && $2 != "c"'''
      'AU-12':
        name: 'AUDIT GENERATION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure "/etc/audit/audit.rules" contains'
            parameters:
              - 'audit_time_rules-a always,exit -F arch=b64 -S adjtimex -k audit_time_rules'
              - 'audit_time_rules-a always,exit -F arch=b64 -S settimeofday -k audit_time_rules'
              - 'audit_time_rules-a always,exit -F arch=b64 -S clock_settime -k audit_time_rules'
              - '-w /etc/localtime -p wa -k audit_time_rules'
              - '-w /etc/sudoers -p wa -k actions'
              - '-w /sbin/insmod -p x -k modules'
              - '-w /sbin/rmmod -p x -k modules'
              - '-w /sbin/modprobe -p x -k modules'
              - '-a always,exit -F arch=b64 -S init_module -S delete_module -k modules'
              - '-a always,exit -F arch=b32 -S chmod -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b32 -S chmod -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b64 -S chmod -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b64 -S chmod -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b32 -S fchmod -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b32 -S fchmod -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b64 -S fchmod -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b64 -S fchmod -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b32 -S fchmodat -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b32 -S fchmodat -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b64 -S fchmodat -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b64 -S fchmodat -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b32 -S fchown -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b32 -S fchown -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b64 -S fchown -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b64 -S fchown -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b32 -S fchownat -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b32 -S fchownat -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b64 -S fchownat -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b64 -S fchownat -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b32 -S fremovexattr -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b32 -S fremovexattr -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b32 -S fsetxattr -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b32 -S fsetxattr -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b32 -S lchown -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b32 -S lchown -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b32 -S lremovexattr -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b32 -S lremovexattr -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b64 -S lremovexattr -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b64 -S lremovexattr -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b32 -S lsetxattr -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b32 -S lsetxattr -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b32 -S removexattr -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b32 -S removexattr -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b32 -S setxattr -F auid>=500 -F auid!=4294967295 -k perm_mod'
              - '-a always,exit -F arch=b32 -S setxattr -F auid=0 -k perm_mod'
              - '-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid>=500 -F auid!=4294967295 -k access'
              - '-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid>=500 -F auid!=4294967295 -k access'
              - '-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid=0 -k access'
              - '-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid=0 -k access'
              - '-a always,exit -F arch=b64 -S mount -F auid>=500 -F auid!=4294967295 -k export'
              - '-a always,exit -F arch=b64 -S mount -F auid=0 -k export'
              - '-a always,exit -F arch=b64 -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid>=500 -F auid!=4294967295 -k delete'
              - '-a always,exit -F arch=b64 -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid=0 -k delete'
          - action: 'Ensure the "kernel" entry in "/etc/grub.conf" contains'
            parameters:
              - 'audit=1'
      'CM-5(6)':
        name: 'ACCESS RESTRICTIONS FOR CHANGE | LIMIT PRODUCTION / OPERATIONAL PRIVILEGES'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Execute the commands'
            parameters:
              - 'chmod go-w /lib/*'
              - 'chmod go-w /lib64/*'
              - 'chmod go-w /usr/lib/*'
              - 'chmod go-w /usr/lib64/*'
              - 'chmod go-w /bin/*'
              - 'chmod go-w /usr/bin/*'
              - 'chmod go-w /usr/local/bin/*'
              - 'chmod go-w /sbin/*'
              - 'chmod go-w /usr/sbin/*'
              - 'chmod go-w /usr/local/sbin/*'
              - 'chown root /lib/*'
              - 'chown root /lib64/*'
              - 'chown root /usr/lib/*'
              - 'chown root /usr/lib64/*'
              - 'chown root /bin/*'
              - 'chown root /usr/bin/*'
              - 'chown root /usr/local/bin/*'
              - 'chown root /sbin/*'
              - 'chown root /usr/sbin/*'
              - 'chown root /usr/local/sbin/*'
      'CM-6':
        name: 'CONFIGURATION SETTINGS'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Check that "/tmp" is mounted on a dedicated partition'
            parameters:
              - 'grep -e "[\s]/tmp[\s]" "/etc/fstab"'
          - action: 'Check that "/var" is mounted on a dedicated partition'
            parameters:
              - 'grep -e "[\s]/var[\s]" "/etc/fstab"'
          - action: 'Check that "/var/log" is mounted on a dedicated partition'
            parameters:
              - 'grep -e "[\s]/var/log[\s]" "/etc/fstab"'
          - action: 'Check that "/home" is mounted on a dedicated partition'
            parameters:
              - 'grep -e "[\s]/home[\s]" "/etc/fstab"'
          - action: 'Ensure selinux is not disabled when loading the kernel'
            parameters:
              - 'sed -i -e ''s/selinux=0/selinux=1/g'' /boot/grub/grub.conf'
          - action: 'Ensure selinux is set to enabled at boot time'
            parameters:
              - 'sed -i -e ''s/^SELINUX=.*/SELINUX=enforcing/'' /etc/selinux/config'
          - action: 'Ensure selinux is using the "targeted" policy'
            parameters:
              - 'sed -i -e ''s/^SELINUXTYPE=.*/SELINUX=targeted/'' /etc/selinux/config'
          - action: 'Check for device files with the SELinux type "unlabeled_t"'
            parameters:
              - 'find /dev -print | xargs ls -dZ /dev 2> /dev/null | grep unlabeled_t | awk ''{print $5}'''
          - action: 'For system accounts, ensure a password is set or disable logon by locking the account'
            parameters:
              - 'passwd -l [SYSACCT]'
          - action: 'Ensure accounts may not logon with null passwords'
            parameters:
              - 'sed -i -e ''s/[\s]*nullok[\s]/ /g'' /etc/pam.d/system-auth-ac'
          - action: 'Ensure account passwords are not stored in /etc/passwd'
            parameters:
              - '/usr/sbin/pwconv'
          - action: 'Ensure only "root" has a uid of 0'
            parameters:
              - '[Delete and recreate any non-root account with a uid of 0]'
          - action: 'Ensure secure file permissions and ownership on critical files'
            parameters:
              - 'chown root /etc/shadow'
              - 'chgrp root /etc/shadow'
              - 'chmod 0000 /etc/shadow'
              - 'chown root /etc/gshadow'
              - 'chgrp root /etc/gshadow'
              - 'chmod 0000 /etc/gshadow'
              - 'chown root /etc/passwd'
              - 'chgrp root /etc/passwd'
              - 'chmod 0644 /etc/passwd'
              - 'chown root /etc/group'
              - 'chgrp root /etc/group'
              - 'chmod 644 /etc/group'
              - 'chown root /etc/grub.conf'
              - 'chgrp root /etc/grub.conf'
              - 'chmod 600 /boot/grub/grub.conf'
          - action: 'Ensure "/etc/login.defs" contains the setting'
            parameters:
              - 'PASS_WARN_AGE 7'
          - action: 'Ensure "/etc/sysctl.conf" contains the settings'
            parameters:
              - 'kernel.randomize_va_space = 2'
              - 'kernel.exec-shield = 1'
              - 'net.ipv4.conf.default.send_redirects = 0'
              - 'net.ipv4.conf.all.send_redirects = 0'
              - 'net.ipv4.ip_forward = 0'
              - 'net.ipv4.conf.all.accept_source_route = 0'
              - 'net.ipv4.conf.all.accept_redirects = 0'
              - 'net.ipv4.conf.all.secure_redirects = 0'
              - 'net.ipv4.conf.all.log_martians = 1'
              - 'net.ipv4.conf.default.accept_source_route = 0'
              - 'net.ipv4.conf.default.secure_redirects = 0'
              - 'net.ipv4.conf.default.accept_redirects = 0'
              - 'net.ipv4.icmp_echo_ignore_broadcasts = 1'
              - 'net.ipv4.icmp_ignore_bogus_error_responses = 1'
              - 'net.ipv4.conf.all.rp_filter = 1'
              - 'net.ipv4.conf.default.rp_filter = 1'
              - 'net.ipv6.conf.default.accept_redirects = 0'
          - action: 'Execute the commands'
            parameters:
              - 'sysctl -w kernel.randomize_va_space=2'
              - 'sysctl -w kernel.exec-shield = 1'
              - 'sysctl -w net.ipv4.conf.default.send_redirects = 0'
              - 'sysctl -w net.ipv4.conf.all.send_redirects = 0'
              - 'sysctl -w net.ipv4.ip_forward = 0'
              - 'sysctl -w net.ipv4.conf.all.accept_source_route = 0'
              - 'sysctl -w net.ipv4.conf.all.accept_redirects = 0'
              - 'sysctl -w net.ipv4.conf.all.secure_redirects = 0'
              - 'sysctl -w net.ipv4.conf.all.log_martians = 1'
              - 'sysctl -w net.ipv4.conf.default.accept_source_route = 0'
              - 'sysctl -w net.ipv4.conf.default.secure_redirects = 0'
              - 'sysctl -w net.ipv4.conf.default.accept_redirects = 0'
              - 'sysctl -w net.ipv4.icmp_echo_ignore_broadcasts = 1'
              - 'sysctl -w net.ipv4.icmp_ignore_bogus_error_responses = 1'
              - 'sysctl -w net.ipv4.conf.all.rp_filter = 1'
              - 'sysctl -w net.ipv4.conf.default.rp_filter = 1'
              - 'sysctl -w net.ipv6.conf.default.accept_redirects = 0'
          - action: 'Ensure "/etc/modprobe.d/disabled.conf" contains the setting'
            parameters:
              - 'options ipv6 disable=1'
          - action: 'Ensure the package "logrotate" is installed properly'
            parameters:
              - 'yum -y reinstall logrotate'
          - action: 'Ensure "/etc/audit/auditd.conf" contains the settings'
            parameters:
              - 'num_logs = 5'
              - 'max_log_file = 6'
              - 'max_log_file_action = rotate'
              - 'admin_space_left_action = suspend'
          - action: 'Ensure "/etc/audit/audit.rules" contains the settings'
            parameters:
              - '-a always,exit -F arch=b64 -S sethostname -S setdomainname -k audit_network_modifications'
              - '-w /etc/issue -p wa -k audit_network_modifications'
              - '-w /etc/issue.net -p wa -k audit_network_modifications'
              - '-w /etc/hosts -p wa -k audit_network_modifications'
              - '-w /etc/sysconfig/network -p wa -k audit_network_modifications'
              - '-w /etc/selinux/ -p wa -k MAC-policy'
          - action: 'Ensure the service "crond" is enabled and running'
            parameters:
              - 'chkconfig crond on'
              - 'service crond start'
          - action: 'Ensure the service "avahi-daemon" is disabled and stopped'
            parameters:
              - 'chkconfig crond off'
              - 'service crond stop'
          - action: 'Remove the package "openldap-servers"'
            parameters:
              - 'yum -y remove openldap-servers'
          - action: 'Ensure NFS mounts are using the "nodev" mount option'
            parameters:
              - '[Re-mount NFS devices that are not currently mounted with the "nodev" option]'
              - '[Add the "nodev" option to NFS devices listed in "/etc/fstab"]'
          - action: 'Ensure NFS mounts are using the "nosuid" mount option'
            parameters:
              - '[Re-mount NFS devices that are not currently mounted with the "nosuid" option]'
              - '[Add the "nosuid" option to NFS devices listed in "/etc/fstab"]'
          - action: 'Ensure "/etc/samba/smb.conf" contains the settings'
            parameters:
              - 'client signing = mandatory'
          - action: 'Check whether CIFS mounts are using the "sec=krb5i" or "sec=ntlmv2i" mount options'
            parameters:
              - '[Warn if CIFS mounts are not using mount options "sec=krb5i" or "sec=ntlmv2i"]'
          - action: 'Ensure there are no world writeable files on the system'
            parameters:
              - '[Execute "chmod o-w <filename>" on all world writeable files]'
          - action: 'Ensure "/etc/init/control-alt-delete.override" contains the setting'
            parameters:
              - 'exec /usr/bin/logger -p security.info "Ctrl-Alt-Delete pressed"'
          - action: 'Ensure the package "postfix" is installed, enabled, and running'
            parameters:
              - 'yum -y install postfix'
              - 'chkconfig postfix on'
              - 'service postfix start'
          - action: 'Ensure the package "sendmail" is removed'
            parameters:
              - 'yum -y remove sendmail'
          - action: 'Check for network interfaces using DHCP'
            parameters:
              - '[Warn if any network interfaces are configured to use DHCP]'
          - action: 'Check that all groups referenced in "/etc/passwd" are defined in "/etc/group"'
            parameters:
              - '[Warn if any groups referenced in "/etc/passwd" are missing from "/etc/group"]'
          - action: 'Ensure "pam_cracklib" in "/etc/pam.d/system-auth-ac" is requiring the settings'
            parameters:
              - 'maxrepeat=3'
          - action: 'Ensure "/etc/security/limits.conf" contains the settings'
            parameters:
              - '* hard core 0'
          - action: 'Set the sticky bit on public, world-writeable directories'
            parameters:
              - 'chmod 1777 /tmp'
              - 'chmod 1777 /var/tmp'
          - action: 'Check for world-writeable directories that are not owned by root'
            parameters:
              - '[Warn if there are world-writeable directories that are not owned by root]'
          - action: 'If "tftpd" is installed, ensure "/etc/xinetd.d/tftp" contains the setting'
            parameters:
              - 'server_args = -s /var/lib/tftpboot'
          - action: 'If "snmpd" is installed, ensure it is not configured to use "v1","v2c", or "com2sec"'
            parameters:
              - '[Comment out from "/etc/snmp/snmpd.conf" lines containing "v1","v2c", or "com2sec"'
          - action: 'If "snmpd" is installed, ensure it is not configured to use default community string "public"'
            parameters:
              - '[Comment out from "/etc/snmp/snmpd.conf" lines containing "public"'
          - descripton: 'Ensure "/etc/bashrc" contains the settings'
            parameters:
              - 'umask 0777'
          - action: 'Ensure "/etc/csh.cshrc" contains the settings'
            parameters:
              - 'umask 0777'
          - action: 'Ensure "/etc/profile" contains the settings'
            parameters:
              - 'umask 0777'
          - action: 'Ensure "/etc/login.defs" contains the settings'
            parameters:
              - 'UMASK 0777'
          - action: 'Ensure "/etc/init.d/functions" contains the settings'
            parameters:
              - 'UMASK 0777'
          - action: 'Ensure "/etc/pam.d/system-auth-ac" contains the settings'
            parameters:
              - 'session     required      pam_lastlog.so showfailed'
          - action: 'Ensure ownership of files and directories managed by the RPM database is correct'
            parameters:
              - '[Use "rpm --setugids" to update files and directories with incorrect ownership]'
          - action: 'Ensure persmissions of files and directories managed by the RPM database are correct'
            parameters:
              - '[Use "rpm --setperms" to update files and directories with incorrect permissions]'
          - action: 'Check for files with a hash different from that expected by the RPM database'
            parameters:
              - '[Warn if any files have a hash different from that expected by the RPM database]'
          - action: 'If installed, ensure "autofs" is disabled and stopped'
            parameters:
              - 'chkconfig autofs off'
              - 'service autofs stop'
          - action: 'If installed, configure "gdm" to disable the display of known users'
            parameters:
              - '/usr/bin/gconftool-2 --direct --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory --type bool --set /apps/gdm/simple-greeter/disable_user_list true'
      'CM-7':
        name: 'LEAST FUNCTIONALITY'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure the service "rhnsd" is not running and is disabled'
            parameters:
              - 'chkconfig rhnsd off'
              - 'service rhnsd stop'
          - action: 'Disable "dccp" by ensuring "/etc/modprobe.d/dccp.conf" contains'
            parameters:
              - 'install dccp /bin/false'
          - action: 'Disable "sctp" by ensuring "/etc/modprobe.d/sctp.conf" contains'
            parameters:
              - 'install sctp /bin/false'
          - action: 'Disable "rds" by ensuring "/etc/modprobe.d/rds.conf" contains'
            parameters:
              - 'install rds /bin/false'
          - action: 'Disable "tipc" by ensuring "/etc/modprobe.d/tipc.conf" contains'
            parameters:
              - 'install tipc /bin/false'
          - action: 'If installed, ensure the service "xinetd" is not running and is disabled'
            parameters:
              - 'chkconfig xinetd off'
              - 'service xinetd stop'
          - action: 'Uninstall the package "xinetd"'
            parameters:
              - 'yum erase xinetd'
          - action: 'If installed, ensure the service "telnet" is disabled'
            parameters:
              - 'chkconfig telnet off'
          - action: 'Uninstall the package "telnet-server"'
            parameters:
              - 'yum erase telnet-server'
          - action: 'If installed, ensure the service "rsh" is disabled'
            parameters:
              - 'chkconfig rsh off'
          - action: 'Uninstall the package "rsh-server"'
            parameters:
              - 'yum erase rsh-server'
          - action: 'Uninstall the package "ypserve"'
            parameters:
              - 'yum erase ypserve'
          - action: 'If installed, ensure the service "ypbind" is not running and is disabled'
            parameters:
              - 'chkconfig ypbind off'
              - 'service ypbind stop'
          - action: 'Uninstall the package "tftp-server"'
            parameters:
              - 'yum erase tftp-server'
          - action: 'If installed, ensure the service "tftp" is not running and is disabled'
            parameters:
              - 'chkconfig tftp off'
              - 'service tftp stop'
          - action: 'If package "postfix" is installed, ensure "/etc/postfix/main.cf contains'
            parameters:
              - 'inet_interfaces = localhost'
          - action: 'If installed, ensure the service "abrtd" is not running and is disabled'
            parameters:
              - 'chkconfig abrtd off'
              - 'service abrtd stop'
          - action: 'If installed, ensure the service "atd" is not running and is disabled'
            parameters:
              - 'chkconfig atd off'
              - 'service atd stop'
          - action: 'If installed, ensure the service "ntpdate" is not running and is disabled'
            parameters:
              - 'chkconfig ntpdate off'
              - 'service ntpdate stop'
          - action: 'If installed, ensure the service "oddjobd" is not running and is disabled'
            parameters:
              - 'chkconfig oddjobd off'
              - 'service oddjobd stop'
          - action: 'If installed, ensure the service "qpidd" is not running and is disabled'
            parameters:
              - 'chkconfig qpidd off'
              - 'service qpidd stop'
          - action: 'If installed, ensure the service "rdisc" is not running and is disabled'
            parameters:
              - 'chkconfig rdisc off'
              - 'service rdisc stop'
          - action: 'If installed, ensure the service "netconsole" is not running and is disabled'
            parameters:
              - 'chkconfig netconsole off'
              - 'service netconsole stop'
          - action: 'Ensure partition "/tmp" is mounted with option "noexec" in "/etc/fstab"'
            parameters:
              - '[Parse /etc/fstab for /tmp and noexec, and add the option if it is missing]'
      'CM-8':
        name: 'INFORMATION SYSTEM COMPONENT INVENTORY'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Check whether "aide --check" is configured to execute periodically'
            parameters:
              - '[Warn if aide is not present in /etc/crontab]'
      'CM-11(2)':
        name: 'USER-INSTALLED SOFTWARE | PROHIBIT INSTALLATION WITHOUT PRIVILEGED STATUS'
        type: 'Common'
        source_ref: 'NIST 800-53 rev 4'
        implementation:
          - action: 'Native feature of the target OS'
            parameters:
              - 'Non-privileged users are prevented from executing privileged functions, including software installation'
      'IA-2':
        name: 'IDENTIFICATION AND AUTHENTICATION (ORGANIZATIONAL USERS)'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure "/etc/exports" does not export volumes with the option "insecure_locks"'
            parameters:
              - 'sed -i ''{
                  s/,insecure_locks)/)/
                  s/(insecure_locks,/(/
                  s/,insecure_locks,/,/
                  s/(insecure_locks)//
                }'' /etc/exports'
          - action: 'Ensure "/etc/exports" does not export volumes with the option "all_squash"'
            parameters:
              - 'sed -i ''{
                  s/,all_squash)/)/
                  s/(all_squash,/(/
                  s/,all_squash,/,/
                  s/(all_squash)//
                }'' /etc/exports'
      'IA-2(2)':
        name: 'IDENTIFICATION AND AUTHENTICATION | NETWORK ACCESS TO NON-PRIVILEGED ACCOUNTS'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure "/etc/ssh/sshd_config" contain the settings'
            parameters:
              - 'IgnoreRhosts yes'
              - 'HostbasedAuthentication no'
              - 'PermitEmptyPasswords no'
      'IA-2(5)':
        name: 'IDENTIFICATION AND AUTHENTICATION | GROUP AUTHENTICATION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure "/etc/securetty" does not contain lines that begin with "vc/"'
            parameters:
              - 'sed -i -e ''s/^vc\/# vc\//g'' /etc/securetty'
          - action: 'Ensure "/etc/securetty" does not contain lines that begin with "ttyS/"'
            parameters:
              - 'sed -i -e ''s/^ttyS.*$//g'' /etc/securetty'
          - action: 'Ensure "/etc/ssh/sshd_config" contain the settings'
            parameters:
              - 'PermitRootLogin no'
      'IA-4':
        name: 'IDENTIFIER MANAGEMENT'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure "/etc/default/useradd" contains the settings'
            parameters:
              - 'INACTIVE=35'
      'IA-5(1)':
        name: 'AUTHENTICATOR MANAGEMENT | PASSWORD-BASED AUTHENTICATION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure "/etc/login.defs" contains the settings'
            parameters:
              - 'PASS_MIN_LEN 14'
              - 'PASS_MIN_DAYS 1'
              - 'PASS_MAX_DAYS 60'
          - action: 'Ensure "/etc/pam.d/system-auth-ac" contains the line
                    "password requisite pam_cracklib.so" with these parameters'
            parameters:
              - 'dcredit=-1'
              - 'ucredit=-1'
              - 'ocredit=-1'
              - 'lcredit=-1'
              - 'difok=-1'
          - action: 'Ensure "/etc/pam.d/system-auth-ac" contains the line
                    "password sufficient pam_unix.so" with these parameters'
            parameters:
              - 'remember=24'
          - action: 'Ensure no user has a ".netrc" file in their home directory'
            parameters:
              - '[For each user, check for "<home>/.netrc" and rename it if present]'
      'IA-5(4)':
        name: 'AUTHENTICATOR MANAGEMENT | AUTOMATED SUPPORT FOR PASSWORD STRENGTH DETERMINATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Ensure "/etc/pam.d/system-auth-ac" contains the line
                    "password requisite pam_cracklib.so" with these parameters'
            parameters:
              - 'dcredit=-1'
              - 'ucredit=-1'
              - 'ocredit=-1'
              - 'lcredit=-1'
              - 'difok=-1'
      'IA-6':
        name: 'AUTHENTICATOR FEEDBACK'
        type: 'Hybrid'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'This is a native feature of the target OS'
      'IA-7':
        name: 'CRYPTOGRAPHIC MODULE AUTHENTICATION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure "/etc/pam.d/system-auth-ac" contains the line
                    "password sufficient pam_unix.so" with these parameters'
            parameters:
              - 'sha512'
          - action: 'Ensure "/etc/login.defs" contains the settings'
            parameters:
              - 'ENCRYPT_METHOD SHA512'
          - action: 'Ensure "/etc/libuser.conf" contains the settings'
            parameters:
              - 'crypt_style = sha512'
      'IA-8':
        name: 'IDENTIFICATION AND AUTHENTICATION (NON-ORGANIZATIONAL USERS)'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Check for accounts with duplicate names'
            parameters:
              - '/usr/sbin/pwck -rq'
      'MA-4':
        name: 'NONLOCAL MAINTENANCE'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure "" contains the settings'
            parameters:
              - 'ClientAliveCountMax 0'
      'SC-5(2)':
        name: 'DENIAL OF SERVICE PROTECTION | EXCESS CAPACITY / BANDWIDTH / REDUNDANCY'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure "/etc/sysctl.conf" contains the settings'
            parameters:
              - 'net.ipv4.tcp_syncookies = 1'
      'SC-7':
        name: 'BOUNDARY PROTECTION'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure the service "ipstables6" is enabled and running'
            parameters:
              - 'chkconfig iptables6 on'
              - 'service iptables6 start'
          - action: 'Ensure the service "ipstables" is enabled and running'
            parameters:
              - 'chkconfig iptables on'
              - 'service iptables start'
      'SC-7(5)':
        name: 'BOUNDARY PROTECTION | DENY BY DEFAULT / ALLOW BY EXCEPTION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure "/etc/sysconfig/iptables" contains the settings'
            parameters:
              - 'FORWARD DROP [0:0]'
      'SC-10':
        name: 'NETWORK DISCONNECT'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure "/etc/ssh/sshd_config" contains the settings'
            parameters:
              - 'ClientAliveInterval 900'
      'SI-2(2)':
        name: 'FLAW REMEDIATION | AUTOMATED FLAW REMEDIATION STATUS'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Execute the commands'
            parameters:
              - 'yum -y update'
      'SI-11':
        name: 'ERROR HANDLING'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Ensure logging targets specified in "/etc/rsyslog.conf" are owned by root'
            parameters:
              - '[Search /etc/rsyslog.conf for log targets and for each execute "chown root <logtarget>"]'
          - action: 'Ensure logging targets specified in "/etc/rsyslog.conf" belong to the root group'
            parameters:
              - '[Search /etc/rsyslog.conf for log targets and for each execute "chgrp root <logtarget>"]'
          - action: 'Ensure logging targets specified in "/etc/rsyslog.conf" have file permissions of 0600'
            parameters:
              - '[Search /etc/rsyslog.conf for log targets and for each execute "chmod 0600 <logtarget>"]'

  ash-windows-formula:
    targets:
      - 'Microsoft Windows Server 2012 R2'
      - 'Microsoft Windows Server 2008 R2'
    controls:
      'AC-2(4)':
        name: 'ACCOUNT MANAGEMENT | AUTOMATED AUDIT ACTIONS'
        type: 'Common'
        source_ref:
          - 'Value is proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit Security Group
                Management'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit Security Group
                Management'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit User Account
                Management'' with ''Success'' selected.'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit User Account
                Management'' with ''Failure'' selected'
      'AC-3':
        name: 'ACCESS ENFORCEMENT'
        type: 'Common'
        source_ref:
          - 'Values are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'SeInteractiveLogonRight = *S-1-5-32-544'
              - 'SeRemoteInteractiveLogonRight = *S-1-5-32-544'
              - 'SeBatchLogonRight = *S-1-5-32-544'
              - 'SeNetworkLogonRight = *S-1-5-11,*S-1-5-32-544'
              - 'SeDenyBatchLogonRight = *S-1-5-32-546'
              - 'SeDenyServiceLogonRight ='
              - 'SeDenyInteractiveLogonRight = *S-1-5-32-546'
              - 'SeDenyRemoteInteractiveLogonRight = *S-1-5-32-546'
              - 'SeDenyNetworkLogonRight = *S-1-5-32-546'
      'AC-3(4)':
        name: 'ACCESS ENFORCEMENT | DISCRETIONARY ACCESS CONTROL'
        type: 'Common'
        source_ref:
          - 'Value is proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\System\CurrentControlSet\Control\Lsa\EveryoneIncludesAnonymous = 0'
      'AC-6(8)':
        name: 'LEAST PRIVILEGE | PRIVILEGE LEVELS FOR CODE EXECUTION'
        type: 'Common'
        source_ref: 'NIST 800-53 rev 4'
        implementation:
          - action: 'Native feature of the target OS'
      'AC-6(9)':
        name: 'LEAST PRIVILEGE | AUDITING USE OF PRIVILEGED FUNCTIONS'
        type: 'Common'
        source_ref:
          - 'Values are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit Computer
                Account Management'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit Computer
                Account Management'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit Other Account
                Management Events'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit Other Account
                Management Events'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit Security Group
                Management'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit Security Group
                Management'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit User Account
                Management'' with ''Success'' selected.'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit User Account
                Management'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Policy Change -> ''Audit Audit Policy
                Change'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Policy Change -> ''Audit Authentication
                Policy Change'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Privilege Use -> ''Audit Sensitive Privilege
                Use'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Privilege Use -> ''Audit Sensitive Privilege
                Use'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> System -> ''Audit Security State Change''
                with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> System -> ''Audit Security State Change''
                with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> System -> ''Audit Security System
                Extension'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> System -> ''Audit Security System
                Extension'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> System -> ''Audit System Integrity'' with
                ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> System -> ''Audit System Integrity'' with
                ''Failure'' selected'
      'AC-6(10)':
        name: 'LEAST PRIVILEGE | PROHIBIT NON-PRIVILEGED USERS FROM EXECUTING PRIVILEGED FUNCTIONS'
        type: 'Common'
        source_ref:
          - 'Values are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'SeTrustedCredManAccessPrivilege ='
              - 'SeTcbPrivilege ='
              - 'SeIncreaseQuotaPrivilege = *S-1-5-20,*S-1-5-19,*S-1-5-32-544'
              - 'SeBackupPrivilege = *S-1-5-32-544'
              - 'SeChangeNotifyPrivilege = *S-1-5-90-0,*S-1-5-20,*S-1-5-19,*S-1-5-11,*S-1-5-32-544'
              - 'SeSystemTimePrivilege = *S-1-5-32-544,*S-1-5-19'
              - 'SeCreatePagefilePrivilege = *S-1-5-32-544'
              - 'SeCreateTokenPrivilege ='
              - 'SeCreateGlobalPrivilege = *S-1-5-20,*S-1-5-19,*S-1-5-6,*S-1-5-32-544'
              - 'SeCreatePermanentPrivilege ='
              - 'SeCreateSymbolicLinkPrivilege = *S-1-5-32-544'
              - 'SeDebugPrivilege = *S-1-5-32-544'
              - 'SeRemoteShutdownPrivilege = *S-1-5-32-544'
              - 'SeAuditPrivilege = *S-1-5-20,*S-1-5-19'
              - 'SeImpersonatePrivilege = *S-1-5-20,*S-1-5-19,*S-1-5-6,*S-1-5-32-544'
              - 'SeIncreaseBasePriorityPrivilege = *S-1-5-32-544'
              - 'SeLoadDriverPrivilege = *S-1-5-32-544'
              - 'SeLockMemoryPrivilege ='
              - 'SeRelabelPrivilege ='
              - 'SeSystemEnvironmentPrivilege = *S-1-5-32-544'
              - 'SeManageVolumePrivilege = *S-1-5-32-544'
              - 'SeProfileSingleProcessPrivilege = *S-1-5-32-544'
              - 'SeSystemProfilePrivilege = *S-1-5-80-3139157870-2983391045-3678747466-658725712-1809340420,*S-1-5-32-544'
              - 'SeAssignPrimaryTokenPrivilege = *S-1-5-20,*S-1-5-19'
              - 'SeRestorePrivilege = *S-1-5-32-544'
              - 'SeShutdownPrivilege = *S-1-5-32-544'
              - 'SeTakeOwnershipPrivilege = *S-1-5-32-544'
              - 'SeEnableDelegationPrivilege ='
          - action: 'Use local security policy to enforce'
            parameters:
              - 'SeIncreaseWorkingSetPrivilege = *S-1-5-90-0'
            targets:
              - 'Microsoft Windows Server 2012 R2'
          - action: 'Use local security policy to enforce'
            parameters:
              - 'SeIncreaseWorkingSetPrivilege = *S-1-5-90-0'
            targets:
              - 'Microsoft Windows Server 2008 R2'
      'AC-7':
        name: 'UNSUCCESSFUL LOGON ATTEMPTS'
        type: 'Common'
        source_ref:
          - 'Values are proscribed by CNSSI 1253.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'LockoutBadCount = 3'
              - 'ResetLockoutCount = 15'
              - 'LockoutDuration = 15'
      'AC-8':
        name: 'SYSTEM USE NOTIFICATION'
        type: 'Common'
        source_ref:
          - 'Banner text is proscribed by DISA STIG and JTF-GNO CTO 08-008A and DoD CIO Memo, "Policy
            on Use of Department of Defense (DoD) Information Systems Standard Consent Banner and User
            Agreement," dated 9 May 2008.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'LegalNoticeText = <Required consent banner and user agreement>'
              - 'LegalNoticeCaption = DoD Notice and Consent Banner'
      'AC-10':
        name: 'CONCURRENT SESSION CONTROL'
        type: 'Common'
        source_ref:
          - 'Value is proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\fSingleSessionPerUser = 1'
      'AC-11':
        name: 'SESSION LOCK'
        type: 'Common'
        source_ref:
          - 'Values are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\InactivityTimeoutSecs = 900'
              - 'HKCU\Software\Policies\Microsoft\Windows\Control Panel\Desktop\ScreenSaverIsSecure = 1'
      'AC-11(1)':
        name: 'SESSION LOCK | PATTERN-HIDING DISPLAYS'
        type: 'Common'
        source_ref:
          - 'Setting is proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKCU\Software\Policies\Microsoft\Windows\Control Panel\Desktop\ScreenSaveActive = 1'
              - 'HKCU\Software\Policies\Microsoft\Windows\Control Panel\Desktop\SCRNSAVE.EXE = scrnsave.scr'
              - 'HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\System\NoDispScrSavPage = 1'
      'AC-12':
        name: 'SESSION TERMINATION'
        type: 'Common'
        source_ref:
          - 'Setting is proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKCU\Software\Policies\Microsoft\Windows NT\Terminal Services\MaxIdleTime = 900000'
              - 'HKCU\Software\Policies\Microsoft\Windows NT\Terminal Services\MaxDisconnectionTime = 60000'
              - 'HKCU\System\CurrentControlSet\Services\LanManServer\Parameters\autodisconnect = 15'
      'AC-17(1)':
        name: 'REMOTE ACCESS | AUTOMATED MONITORING / CONTROL'
        type: 'Common'
        source_ref:
          - 'Setting is proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Logon/Logoff -> ''Audit Logoff'' with
                ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Logon/Logoff -> ''Audit Logon'' with
                ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Logon/Logoff -> ''Audit Logon'' with
                ''Failure'' selected'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\fDisableCcm = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\fDisableLPT = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\fEnableSmartCard = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\fDisablePNPRedir = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoDisconnect = 1'
      'AC-17(2)':
        name: 'REMOTE ACCESS | PROTECTION OF CONFIDENTIALITY / INTEGRITY USING ENCRYPTION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\MinEncryptionLevel = 3'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\fEncryptRPCTraffic = 1'
      'AU-3':
        name: 'CONTENT OF AUDIT RECORDS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Native feature of the target OS'
      'AU-3(1)':
        name: 'CONTENT OF AUDIT RECORDS | ADDITIONAL AUDIT INFORMATION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\Audit\ProcessCreationIncludeCmdLine_Enabled = 0'
      'AU-4':
        name: 'AUDIT STORAGE CAPACITY'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows\EventLog\Application\MaxSize = 32768'
              - 'HKLM\Software\Policies\Microsoft\Windows\EventLog\Security\MaxSize = 196608'
              - 'HKLM\Software\Policies\Microsoft\Windows\EventLog\Setup\MaxSize = 32768'
              - 'HKLM\Software\Policies\Microsoft\Windows\EventLog\System\MaxSize = 32768'
      'AU-5':
        name: 'RESPONSE TO AUDIT PROCESSING FAILURES'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\System\CurrentControlSet\Control\Lsa\CrashOnAuditFail = 0'
              - 'HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Security\WarningLevel = 90'
      'AU-5(1)':
        name: 'RESPONSE TO AUDIT PROCESSING FAILURES | AUDIT STORAGE CAPACITY'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Security\WarningLevel = 90'
      'AU-5(2)':
        name: 'RESPONSE TO AUDIT PROCESSING FAILURES | REAL-TIME ALERTS'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Security\WarningLevel = 90'
      'AU-8':
        name: 'TIME STAMPS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'No action required; Operating System provides this capability by default'
      'AU-9':
        name: 'PROTECTION OF AUDIT INFORMATION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'SeSecurityPrivilege = *S-1-5-32-544'
      'AU-12':
        name: 'AUDIT GENERATION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Logon -> ''Audit Credential
                Validation'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Logon -> ''Audit Credential
                Validation'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit Computer
                Account Management'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit Computer
                Account Management'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit Other Account
                Management Events'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit Other Account
                Management Events'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit Security Group
                Management'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit Security Group
                Management'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit User Account
                Management'' with ''Success'' selected.'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Account Management -> ''Audit User Account
                Management'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Detailed Tracking -> ''Audit Process
                Creation'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Logon/Logoff -> ''Audit Logoff'' with
                ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Logon/Logoff -> ''Audit Logon'' with
                ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Logon/Logoff -> ''Audit Logon'' with
                ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Logon/Logoff -> ''Audit Special Logon'' with
                ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Object Access -> ''Audit Central Access
                Policy Staging'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Object Access -> ''Audit Central Access
                Policy Staging'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Object Access -> ''Audit File System'' with
                ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Object Access -> ''Audit Handle
                Manipulation'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Object Access -> ''Audit Registry'' with
                ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Object Access -> ''Audit Removable Storage''
                with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Object Access -> ''Audit Removable Storage''
                with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Policy Change -> ''Audit Audit Policy
                Change'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Policy Change -> ''Audit Audit Policy
                Change'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Policy Change -> ''Audit Authentication
                Policy Change'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Policy Change -> ''Audit Authorization
                Policy Change'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Policy Change -> ''Audit Authorization
                Policy Change'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Privilege Use -> ''Audit Sensitive Privilege
                Use'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Privilege Use -> ''Audit Sensitive Privilege
                Use'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> System -> ''Audit IPsec Driver'' with
                ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> System -> ''Audit IPsec Driver'' with
                ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> System -> ''Audit Security State Change''
                with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> System -> ''Audit Security State Change''
                with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> System -> ''Audit Security System
                Extension'' with ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> System -> ''Audit Security System
                Extension'' with ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> System -> ''Audit System Integrity'' with
                ''Success'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> System -> ''Audit System Integrity'' with
                ''Failure'' selected'
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Global Object Access Auditing -> ''File
                system'' with ''Principal:  Everyone'', Type:  Fail'', and
                ''Permissions:  all categories selected'''
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Global Object Access Auditing -> ''Registry''
                with ''Principal:  Everyone'', ''Type:  Fail'', and
                ''Permissions:  all categories selected'''
              - 'HKLM\System\CurrentControlSet\Control\Lsa\SCENoApplyLegacyAuditPolicy = 1'
              - 'SeSecurityPrivilege = *S-1-5-32-544'
      'AU-12(3)':
        name: 'AUDIT GENERATION | CHANGES BY AUTHORIZED INDIVIDUALS'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'SeSecurityPrivilege = *S-1-5-32-544'
      'CM-5(1)':
        name: 'ACCESS RESTRICTIONS FOR CHANGE | AUTOMATED ACCESS ENFORCEMENT / AUDITING'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Global Object Access Auditing -> ''File
                system'' with ''Principal:  Everyone'', Type:  Fail'', and
                ''Permissions:  all categories selected'''
              - 'Computer Configuration -> Windows Settings -> Security
                Settings -> Advanced Audit Policy Configuration -> System
                Audit Policies -> Global Object Access Auditing -> ''Registry''
                with ''Principal:  Everyone'', ''Type:  Fail'', and
                ''Permissions:  all categories selected'''
              - 'HKLM\System\CurrentControlSet\Control\Lsa\EveryoneIncludesAnonymous = 0'
      'CM-6':
        name: 'ACCESS RESTRICTIONS FOR CHANGE | AUTOMATED ACCESS ENFORCEMENT / AUDITING'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows\TCPIP\v6Transition\Force_Tunneling = Enabled'
              - 'HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\EnableIPAutoConfigurationLimits = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\DeviceInstall\Settings\DisableSystemRestore = 0'
              - 'HKLM\System\CurrentControlSet\Policies\EarlyLaunch\DriverLoadPolicy = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2}\NoBackgroundPolicy = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2}\NoGPOListChanges = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\Explorer\NoUseStoreOpenWith = 1'
              - 'HKLM\Software\Policies\Microsoft\Power\PowerSettings\3C0BC021-C8A8-4E07-A973-6B14CBCB2B7E\DCSettingIndex = 1200'
              - 'HKLM\Software\Policies\Microsoft\Power\PowerSettings\3C0BC021-C8A8-4E07-A973-6B14CBCB2B7E\ACSettingIndex = 1200'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\LoggingEnabled = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\Appx\AllowAllTrustedApps = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\PreXPSP2ShellProtocolBehavior = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\DeleteTempDirsOnExit = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\PerSessionTempDir = 1'
              - 'HKLM\Software\Policies\Microsoft\Internet Explorer\Feeds\DisableEnclosureDownload = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\Installer\SafeForScripting = 0'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\ReportControllerMissing = 1'
              - 'HKLM\Software\Policies\Microsoft\WindowsMediaPlayer\GroupPrivacyAcceptance = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\RedirectOnlyDefaultClientPrinter = 1'
              - 'HKLM\System\CurrentControlSet\Control\Lsa\LimitBlankPasswordUse = 1'
              - 'NewAdministratorName = "xAdministrator"'
              - 'NewGuestName = "xGuest"'
              - 'HKLM\Software\Microsoft\Windows NT\CurrentVersion\WinLogon\AllocateDASD = 0'
              - 'HKLM\System\CurrentControlSet\Services\Netlogon\Parameters\RefusePasswordChange = 0'
              - 'HKLM\System\CurrentControlSet\Services\Netlogon\Parameters\MaximumPasswordAge = 30'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\DontDisplayLastUserName = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\DisableCAD = 0'
              - 'HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\CachedLogonsCount = "4"'
              - 'HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\PasswordExpiryWarning = 14'
              - 'HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\ScRemoveOption = "1"'
              - 'HKLM\System\CurrentControlSet\Services\LanManServer\Parameters\SMBServerNameHardeningLevel = 0'
              - 'HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\AutoAdminLogon = "0"'
              - 'HKLM\System\CurrentControlSet\Services\Tcpip6\Parameters\DisableIPSourceRouting = 2'
              - 'HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\DisableIPSourceRouting = 2'
              - 'HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\EnableICMPRedirect = 0'
              - 'HKLM\System\CurrentControlSet\Services\IPSEC\NoDefaultExempt = 3'
              - 'HKLM\System\CurrentControlSet\Control\Session Manager\SafeDllSearchMode = 1'
              - 'HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\ScreenSaverGracePeriod = "5"'
              - 'LSAAnonymousNameLookup = 0'
              - 'HKLM\System\CurrentControlSet\Control\Lsa\RestrictAnonymousSAM = 1'
              - 'HKLM\System\CurrentControlSet\Control\Lsa\EveryoneIncludesAnonymous = 0'
              - 'HKLM\System\CurrentControlSet\Control\Lsa\MSV1_0\allownullsessionfallback = 0'
              - 'HKLM\System\CurrentControlSet\Control\Lsa\pku2u\AllowOnlineID = 0'
              - 'HKLM\System\CurrentControlSet\Control\Lsa\LmCompatibilityLevel = 4'
              - 'HKLM\System\CurrentControlSet\Services\LDAP\LDAPClientIntegrity = 1'
              - 'HKLM\System\CurrentControlSet\Control\Lsa\MSV1_0\NTLMMinClientSec = 537395200'
              - 'HKLM\System\CurrentControlSet\Control\Lsa\MSV1_0\NTLMMinServerSec = 537395200'
              - 'HKLM\Software\Microsoft\Windows NT\CurrentVersion\Setup\RecoveryConsole\securitylevel = 0'
              - 'HKLM\Software\Microsoft\Windows NT\CurrentVersion\Setup\RecoveryConsole\setcommand = 0'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\ShutdownWithoutLogon = 0'
              - 'HKLM\System\CurrentControlSet\Control\Session Manager\Kernel\ObCaseInsensitive = 1'
              - 'HKLM\System\CurrentControlSet\Control\Session Manager\ProtectionMode = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\Safer\CodeIdentifiers\AuthenticodeEnabled = 1'
              - 'SeTimeZonePrivilege = *S-1-5-32-544,*S-1-5-19'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\LogonType = 0'
          - action: 'Ensure the Startup Type for the Smart Card Removal Policy service is ''Automatic'''
            parameters:
              - 'Get-Service -name SCPolicySvc | Set-Service -StartupType
                "Automatic" -PassThru | Start-Service'
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\MSAOptional = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\DisableAutomaticRestartSignOn = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\MaxDevicePasswordFailedAttempts = 10'
            targets:
              - 'Microsoft Windows Server 2012 R2'
      'CM-7':
        name: 'LEAST FUNCTIONALITY'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows\LLTD\EnableLLTDIO = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\LLTD\EnableRspndr = 0'
              - 'HKLM\Software\Policies\Microsoft\Peernet\Disabled = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\Network Connections\NC_AllowNetBridge_NLA = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\TCPIP\v6Transition\6to4_State = "Disabled"'
              - 'HKLM\Software\Policies\Microsoft\Windows\TCPIP\v6Transition\IPHTTPS\IPHTTPSInterface\IPHTTPS_ClientState = 3'
              - 'HKLM\Software\Policies\Microsoft\Windows\TCPIP\v6Transition\IPHTTPS\IPHTTPSInterface\IPHTTPS_ClientUrl = "about:blank"'
              - 'HKLM\Software\Policies\Microsoft\Windows\TCPIP\v6Transition\ISATAP_State = "Disabled"'
              - 'HKLM\Software\Policies\Microsoft\Windows\TCPIP\v6Transition\Teredo_State = "Disabled"'
              - 'HKLM\Software\Policies\Microsoft\Windows\WCN\Registrars\EnableRegistrars = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\WCN\UI\DisableWcnUi = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\DeviceInstall\Settings\AllowRemoteRPC = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\DeviceInstall\Settings\DisableSendGenericDriverNotFoundToWER = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\Device Metadata\PreventDeviceMetadataFromNetwork = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\DeviceInstall\Settings\DisableSendRequestAdditionalSoftwareToWER = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Printers\DisableWebPnPDownload = 1'
              - 'HKLM\Software\Policies\Microsoft\EventViewer\MicrosoftEventVwrDisableLinks = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\HandwritingErrorReports\PreventHandwritingErrorReports = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoInternetOpenWith = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Printers\DisableHTTPPrinting = 1'
              - 'HKLM\Software\Policies\Microsoft\SQMClient\Windows\CEIPEnable = 0'
              - 'HKLM\Software\Policies\Microsoft\Control Panel\International\BlockUserInputMethodsForSignIn = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\System\EnumerateLocalUsers = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\System\DisableLockScreenAppNotifications = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\AppCompat\DisablePcaUI = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\ScriptedDiagnosticsProvider\Policy\DisableQueryRemoteServer = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\ScriptedDiagnosticsProvider\Policy\EnableQueryRemoteServer = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\WDI\{9c5a40da-b965-4fc3-8781-88dd50a6299d}\ScenarioExecutionEnabled = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\AppCompat\DisableInventory = 1'
              - 'HKLM\Software\Policies\Microsoft\Biometrics\Enabled = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\System\EnableSmartScreen = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\LocationAndSensors\DisableLocation = 1'
              - 'HKLM\Software\Policies\Microsoft\Internet Explorer\Feeds\AllowBasicAuthInClear = 0'
              - 'HKLM\Software\Policies\Microsoft\WMDRM\DisableOnline = 1'
              - 'HKLM\System\CurrentControlSet\Control\Session Manager\SubSystems\Optional = []'
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows\Personalization\NoLockScreenSlideshow = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\System\DontDisplayNetworkSelectionUI = 1'
              - 'HKCU\Software\Policies\Microsoft\Windows\CurrentVersion\PushNotifications\NoToastApplicationNotificationOnLockScreen = 1'
            targets:
              - 'Microsoft Windows Server 2012 R2'
      'CM-7(2)':
        name: 'LEAST FUNCTIONALITY | PREVENT PROGRAM EXECUTION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows\Explorer\NoAutoplayfornonVolume = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoAutorun = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoDriveTypeAutoRun = 255'
      'CM-11(2)':
        name: 'USER-INSTALLED SOFTWARE | PROHIBIT INSTALLATION WITHOUT PRIVILEGED STATUS'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Printers\DoNotInstallCompatibleDriverFromWindowsUpdate = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Servicing\UseWindowsUpdate = 2'
              - 'HKLM\Software\Policies\Microsoft\Windows\DriverSearching\SearchOrderConfig = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\DriverSearching\DriverServerSelection = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\DriverSearching\DontPromptForWindowsUpdate = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\DriverSearching\DontSearchWindowsUpdate = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\Installer\EnableUserControl = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\Installer\DisableLUAPatching = 1'
              - 'HKLM\Software\Policies\Microsoft\WindowsMediaPlayer\DisableAutoUpdate = 1'
              - 'HKLM\System\CurrentControlSet\Control\Print\Providers\LanMan Print Services\Servers\AddPrinterDrivers = 1'
      'IA-3':
        name: 'DEVICE IDENTIFICATION AND AUTHENTICATION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\System\CurrentControlSet\Control\Lsa\UseMachineId = 1'
      'IA-3(1)':
        name: 'DEVICE IDENTIFICATION AND AUTHENTICATION | CRYPTOGRAPHIC BIDIRECTIONAL AUTHENTICATION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Rpc\EnableAuthEpResolution = 1'
              - 'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Rpc\RestrictRemoteClients = 1'
      'IA-5(1)':
        name: 'AUTHENTICATOR MANAGEMENT | PASSWORD-BASED AUTHENTICATION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'PasswordHistorySize = 24'
              - 'MaximumPasswordAge = 60'
              - 'MinimumPasswordAge = 1'
              - 'MinimumPasswordLength = 14'
              - 'PasswordComplexity = 1'
              - 'ClearTextPassword = 0'
              - 'HKLM\System\CurrentControlSet\Services\LanmanWorkstation\Parameters\EnablePlainTextPassword = 0'
              - 'HKLM\System\CurrentControlSet\Control\Lsa\NoLMHash = 1'
      'IA-5(2)':
        name: 'AUTHENTICATOR MANAGEMENT | PKI-BASED AUTHENTICATION'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\SystemCertificates\AuthRoot\DisableRootAutoUpdate = 1'
              - 'HKLM\Software\Policies\Microsoft\Cryptography\ForceKeyProtection = 2'
      'IA-5(4)':
        name: 'AUTHENTICATOR MANAGEMENT | AUTOMATED SUPPORT FOR PASSWORD STRENGTH DETERMINATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'PasswordComplexity = 1'
      'IA-6':
        name: 'AUTHENTICATOR FEEDBACK'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows\CredUI\DisablePasswordReveal = 1'
      'IA-7':
        name: 'CRYPTOGRAPHIC MODULE AUTHENTICATION'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters\SupportedEncryptionTypes = 2147483644'
      'IA-8':
        name: 'IDENTIFICATION AND AUTHENTICATION (NON-ORGANIZATIONAL USERS)'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'EnableGuestAccount = 0'
      'IA-11':
        name: 'RE-AUTHENTICATION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51\DCSettingIndex = 1'
              - 'HKLM\Software\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51\ACSettingIndex = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\DisablePasswordSaving = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\fPromptForPassword = 1'
              - 'HKLM\Software\Policies\Microsoft\Windows\WinRM\Service\DisableRunAs = 1'
              - 'HKLM\System\CurrentControlSet\Control\Lsa\DisableDomainCreds = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\FilterAdministratorToken = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\ConsentPromptBehaviorUser = 0'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA = 1'
      'MA-4':
        name: 'NONLOCAL MAINTENANCE'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows\WinRM\Client\AllowBasic = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\WinRM\Client\AllowDigest = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\WinRM\Service\AllowBasic = 0'
      'MA-4(6)':
        name: 'NONLOCAL MAINTENANCE | CRYPTOGRAPHIC PROTECTION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\MinEncryptionLevel = 3'
              - 'HKLM\Software\Policies\Microsoft\Windows\WinRM\Client\AllowUnencryptedTraffic = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\WinRM\Service\AllowUnencryptedTraffic = 0'
      'SC-3':
        name: 'SECURITY FUNCTION ISOLATION'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows\Network Connections\NC_StdDomainUserSetLocation = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\CredUI\EnumerateAdministrators = 0'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableInstallerDetection = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\ValidateAdminCodeSignatures = 0'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableSecureUIAPaths = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\PromptOnSecureDesktop = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableVirtualization = 1'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableUIADesktopToggle = 0'
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy = 0'
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\ConsentPromptBehaviorAdmin = 2'
            targets:
              - 'Microsoft Windows Server 2012 R2'
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\ConsentPromptBehaviorAdmin = 4'
            targets:
              - 'Microsoft Windows Server 2008 R2'
      'SC-4':
        name: 'INFORMATION IN SHARED RESOURCES'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\fAllowUnsolicited = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\fAllowToGetHelp = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\fDisableCdm = 1'
              - 'HKLM\System\CurrentControlSet\Control\Lsa\RestrictAnonymous = 1'
              - 'HKLM\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedExactPaths\Machine =
                ["System\CurrentControlSet\Control\ProductOptions",
                "System\CurrentControlSet\Control\Server Applications",
                "Software\Microsoft\Windows NT\CurrentVersion"]'
              - 'HKLM\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths\Machine =
                ["System\CurrentControlSet\Control\Print\Printers",
                "System\CurrentControlSet\Services\Eventlog",
                "Software\Microsoft\OLAP Server",
                "Software\Microsoft\Windows NT\CurrentVersion\Print",
                "Software\Microsoft\Windows NT\CurrentVersion\Windows",
                "System\CurrentControlSet\Control\ContentIndex",
                "System\CurrentControlSet\Control\Terminal Server",
                "System\CurrentControlSet\Control\Terminal Server\UserConfig",
                "System\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration",
                "Software\Microsoft\Windows NT\CurrentVersion\Perflib",
                "System\CurrentControlSet\Services\SysmonLog"]'
              - 'HKLM\System\CurrentControlSet\Services\LanManServer\Parameters\RestrictNullSessAccess = 1'
              - 'HKLM\System\CurrentControlSet\Services\LanManServer\Parameters\NullSessionShares = []'
              - 'HKLM\System\CurrentControlSet\Control\Lsa\ForceGuest = 0'
      'SC-5':
        name: 'DENIAL OF SERVICE PROTECTION'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows\Explorer\NoHeapTerminationOnCorruption = 0'
              - 'HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\KeepAliveTime = 300000'
              - 'HKLM\System\CurrentControlSet\Services\Netbt\Parameters\NoNameReleaseOnDemand = 1'
              - 'HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\PerformRouterDiscovery = 0'
              - 'HKLM\System\CurrentControlSet\Services\Tcpip6\Parameters\TcpMaxDataRetransmissions = 3'
              - 'HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\TcpMaxDataRetransmissions = 3'
      'SC-8(1)':
        name: 'TRANSMISSION CONFIDENTIALITY AND INTEGRITY | CRYPTOGRAPHIC OR ALTERNATE PHYSICAL PROTECTION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\System\CurrentControlSet\Services\Netlogon\Parameters\requiresignorseal = 1'
              - 'HKLM\System\CurrentControlSet\Services\Netlogon\Parameters\sealsecurechannel = 1'
              - 'HKLM\System\CurrentControlSet\Services\Netlogon\Parameters\signsecurechannel = 1'
              - 'HKLM\System\CurrentControlSet\Services\Netlogon\Parameters\requirestrongkey = 1'
              - 'HKLM\System\CurrentControlSet\Services\LanmanWorkstation\Parameters\RequireSecuritySignature = 1'
              - 'HKLM\System\CurrentControlSet\Services\LanmanWorkstation\Parameters\EnableSecuritySignature = 1'
              - 'HKLM\System\CurrentControlSet\Services\LanManServer\Parameters\requiresecuritysignature = 1'
              - 'HKLM\System\CurrentControlSet\Services\LanManServer\Parameters\enablesecuritysignature = 1'
      'SC-10':
        name: 'NETWORK DISCONNECT'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\MaxIdleTime = 900000'
              - 'HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services\MaxDisconnectionTime = 60000'
              - 'HKLM\System\CurrentControlSet\Services\LanManServer\Parameters\autodisconnect = 15'
              - 'HKLM\System\CurrentControlSet\Services\LanManServer\Parameters\enableforcedlogoff = 1'
              - 'ForceLogoffWhenHourExpire = 1'
      'SC-13':
        name: 'CRYPTOGRAPHIC PROTECTION'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\System\CurrentControlSet\Control\Lsa\FIPSAlgorithmPolicy\Enabled = 1'
      'SI-11':
        name: 'ERROR HANDLING'
        type: 'Hybrid'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting\Disabled = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting\LoggingDisabled = 0'
              - 'HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting\DontSendAdditionalData = 1'
      'SI-16':
        name: 'MEMORY PROTECTION'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Use local security policy to enforce'
            parameters:
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\IE = "*\Internet Explorer\iexplore.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\WindowsMediaPlayer = "*\Windows Media Player\wmplayer.exe -SEHOP -EAF -MandatoryASLR"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Skype = "*\Skype\Phone\Skype.exe -EAF"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\LyncCommunicator = "*\Microsoft Lync\communicator.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\WindowsLiveMail = "*\Windows Live\Mail\wlmail.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\PhotoGallery = "*\Windows Live\Photo Gallery\WLXPhotoGallery.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\LiveWriter = "*\Windows Live\Writer\WindowsLiveWriter.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\SkyDrive = "*\SkyDrive\SkyDrive.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Chrome = "*\Google\Chrome\Application\chrome.exe -SEHOP"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\GoogleTalk = "*\Google\Google Talk\googletalk.exe -DEP -SEHOP"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Firefox = "*\Mozilla Firefox\firefox.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\FirefoxPluginContainer = "*\Mozilla Firefox\plugin-container.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Thunderbird = "*\Mozilla Thunderbird\thunderbird.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\ThunderbirdPluginContainer = "*\Mozilla Thunderbird\plugin-container.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Photoshop = "*\Adobe\Adobe Photoshop CS*\Photoshop.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Winamp = "*\Winamp\winamp.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Opera = "*\Opera\opera.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\WinRARGUI = "*\WinRAR\winrar.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\WinRARConsole = "*\WinRAR\rar.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\UnRAR = "*\WinRAR\unrar.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Winzip = "*\WinZip\winzip32.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Winzip64 = "*\WinZip\winzip64.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\VLC = "*\VideoLAN\VLC\vlc.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\RealConverter = "*\Real\RealPlayer\realconverter.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\RealPlayer = "*\Real\RealPlayer\realplay.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\mIRC = "*\mIRC\mirc.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\7z = "*\7-Zip\7z.exe -EAF"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\7zGUI = "*\7-Zip\7zG.exe -EAF"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\7zFM = *\7-Zip\7zFM.exe -EAF"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Safari = "*\Safari\Safari.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\QuickTimePlayer = "*\QuickTime\QuickTimePlayer.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\iTunes = "*\iTunes\iTunes.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Pidgin = "*\Pidgin\pidgin.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\FoxitReader = "*\Foxit Reader\Foxit Reader.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Wordpad = "*\Windows NT\Accessories\wordpad.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Outlook = "*\OFFICE1*\OUTLOOK.EXE"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Word = "*\OFFICE1*\WINWORD.EXE"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Excel = "*\OFFICE1*\EXCEL.EXE"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\PowerPoint = "*\OFFICE1*\POWERPNT.EXE"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Access = "*\OFFICE1*\MSACCESS.EXE"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Publisher = "*\OFFICE1*\MSPUB.EXE"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\InfoPath = "*\OFFICE1*\INFOPATH.EXE"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Visio = "*\OFFICE1*\VISIO.EXE"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\VisioViewer = "*\OFFICE1*\VPREVIEW.EXE"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Lync = "*\OFFICE1*\LYNC.EXE"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\PPTViewer = "*\OFFICE1*\PPTVIEW.EXE"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Picture Manager = "*\OFFICE1*\OIS.EXE"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\AcrobatReader = "*\Adobe\Reader*\Reader\AcroRd32.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\Acrobat = "*\Adobe\Acrobat*\Acrobat\Acrobat.exe"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\jre6_java = "*\Java\jre6\bin\java.exe -HeapSpray"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\jre6_javaw = "*\Java\jre6\bin\javaw.exe -HeapSpray"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\jre6_javaws = "*\Java\jre6\bin\javaws.exe -HeapSpray"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\jre7_java = "*\Java\jre7\bin\java.exe -HeapSpray"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\jre7_javaw = "*\Java\jre7\bin\javaw.exe -HeapSpray"'
              - 'HKCU\Software\Policies\Microsoft\EMET\Defaults\jre7_javaws = "*\Java\jre7\bin\javaws.exe -HeapSpray"'
              - 'HKCU\Software\Policies\Microsoft\EMET\SysSettings\ASLR = 3'
              - 'HKCU\Software\Policies\Microsoft\EMET\SysSettings\DEP = 2'
              - 'HKCU\Software\Policies\Microsoft\EMET\SysSettings\SEHOP = 2'
              - 'HKLM\Software\Policies\Microsoft\Windows\Explorer\NoDataExecutionPrevention = 0'

  EnterpriseLayer-HBSS-formula:
    targets:
      - 'Enterprise Linux 6'
    controls:
      'SC-5(3)':
        name: 'DENIAL OF SERVICE PROTECTION | DETECTION / MONITORING'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install McAfee Agent for Linux'
      'SC-7(12)':
        name: 'BOUNDARY PROTECTION | HOST-BASED PROTECTION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install McAfee Agent for Linux'

  EnterpriseLayer-Splunk-formula:
    targets:
      - 'Enterprise Linux 6'
    controls:
      'AU-3(1)':
        name: 'CONTENT OF AUDIT RECORDS | ADDITIONAL AUDIT INFORMATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-3(2)':
        name: 'CONTENT OF AUDIT RECORDS | CENTRALIZED MANAGEMENT OF PLANNED AUDIT RECORD CONTENT'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-4(1)':
        name: 'AUDIT STORAGE CAPACITY | TRANSFER TO ALTERNATE STORAGE'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-5(1)':
        name: 'RESPONSE TO AUDIT PROCESSING FAILURES | AUDIT STORAGE CAPACITY'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-5(2)':
        name: 'RESPONSE TO AUDIT PROCESSING FAILURES | REAL-TIME ALERTS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(1)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | PROCESS INTEGRATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(3)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | CORRELATE AUDIT REPOSITORIES'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(4)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | CENTRAL REVIEW AND ANALYSIS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(5)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | INTEGRATION / SCANNING AND MONITORING CAPABILITIES'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(6)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | CORRELATION WITH PHYSICAL MONITORING'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(7)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | PERMITTED ACTIONS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(9)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | CORRELATION WITH INFORMATION FROM NONTECHNICAL SOURCES'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(10)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | AUDIT LEVEL ADJUSTMENT'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-7':
        name: 'AUDIT REDUCTION AND REPORT GENERATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-7(1)':
        name: 'AUDIT REDUCTION AND REPORT GENERATION | AUTOMATIC PROCESSING'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-9':
        name: 'PROTECTION OF AUDIT INFORMATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-9(2)':
        name: 'PROTECTION OF AUDIT INFORMATION | AUDIT BACKUP ON SEPARATE PHYSICAL SYSTEMS / COMPONENTS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-9(3)':
        name: 'PROTECTION OF AUDIT INFORMATION | CRYPTOGRAPHIC PROTECTION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-9(4)':
        name: 'PROTECTION OF AUDIT INFORMATION | ACCESS BY SUBSET OF PRIVILEGED USERS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-10':
        name: 'NON-REPUDIATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-10(1)':
        name: 'NON-REPUDIATION | ASSOCIATION OF IDENTITIES'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-10(2)':
        name: 'NON-REPUDIATION | VALIDATE BINDING OF INFORMATION PRODUCER IDENTITY'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-10(3)':
        name: 'NON-REPUDIATION | CHAIN OF CUSTODY'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-10(4)':
        name: 'NON-REPUDIATION | VALIDATE BINDING OF INFORMATION REVIEWER IDENTITY'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-11':
        name: 'AUDIT RECORD RETENTION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-11(1)':
        name: 'AUDIT RECORD RETENTION | LONG-TERM RETRIEVAL CAPABILITY'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-12(1)':
        name: 'AUDIT GENERATION | SYSTEM-WIDE / TIME-CORRELATED AUDIT TRAIL'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-12(3)':
        name: 'AUDIT GENERATION | CHANGES BY AUTHORIZED INDIVIDUALS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'CM-6':
        name: 'CONFIGURATION SETTINGS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'CM-11(1)':
        name: 'USER-INSTALLED SOFTWARE | ALERTS FOR UNAUTHORIZED INSTALLATIONS'
        type: 'Common'
        source_ref: 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'MA-4(1)':
        name: 'NONLOCAL MAINTENANCE | AUDITING AND REVIEW'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'

  join-domain-formula:
    targets:
      - 'Enterprise Linux 6'
      - 'Microsoft Windows Server 2012 R2'
      - 'Microsoft Windows Server 2008 R2'
    controls:
      'AC-2(2)':
        name: 'ACCOUNT MANAGEMENT | REMOVAL OF TEMPORARY / EMERGENCY ACCOUNTS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'
      'AC-2(3)':
        name: 'ACCOUNT MANAGEMENT | DISABLE INACTIVE ACCOUNTS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'
      'AC-2(4)':
        name: 'ACCOUNT MANAGEMENT | AUTOMATED AUDIT ACTIONS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'
      'AC-2(10)':
        name: 'ACCOUNT MANAGEMENT | SHARED / GROUP ACCOUNT CREDENTIAL TERMINATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'
      'AC-2(11)':
        name: 'ACCOUNT MANAGEMENT | USAGE CONDITIONS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'
      'AC-3(4)':
        name: 'ACCESS ENFORCEMENT | DISCRETIONARY ACCESS CONTROL'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'
      'AC-7':
        name: 'UNSUCCESSFUL LOGON ATTEMPTS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'
      'AU-8(1)':
        name: 'TIME STAMPS | SYNCHRONIZATION WITH AUTHORITATIVE TIME SOURCE'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'
      'AU-12(1)':
        name: 'AUDIT GENERATION | SYSTEM-WIDE / TIME-CORRELATED AUDIT TRAIL'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'
      'IA-2':
        name: 'IDENTIFICATION AND AUTHENTICATION (ORGANIZATIONAL USERS)'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'
      'IA-2(8)':
        name: 'IDENTIFICATION AND AUTHENTICATION | NETWORK ACCESS TO PRIVILEGED ACCOUNTS - REPLAY RESISTANT'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'
      'IA-2(9)':
        name: 'IDENTIFICATION AND AUTHENTICATION | NETWORK ACCESS TO NON-PRIVILEGED ACCOUNTS - REPLAY RESISTANT'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'
      'IA-3':
        name: 'DEVICE IDENTIFICATION AND AUTHENTICATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'
      'IA-3(1)':
        name: 'DEVICE IDENTIFICATION AND AUTHENTICATION | CRYPTOGRAPHIC BIDIRECTIONAL AUTHENTICATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'
      'IA-5(1)':
        name: 'AUTHENTICATOR MANAGEMENT | PASSWORD-BASED AUTHENTICATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'
      'IA-5(4)':
        name: 'AUTHENTICATOR MANAGEMENT | AUTOMATED SUPPORT FOR PASSWORD STRENGTH DETERMINATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Join the Active Directory domain'
            parameters: '[Name of the Active Directory domain]'

  mcafee-agent-windows-formula:
    targets:
      - 'Microsoft Windows Server 2012 R2'
      - 'Microsoft Windows Server 2008 R2'
    controls:
      'CM-6':
        name: 'CONFIGURATION SETTINGS'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Install McAfee Agent for Windows'
      'SC-5(3)':
        name: 'DENIAL OF SERVICE PROTECTION | DETECTION / MONITORING'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install McAfee Agent for Windows'
      'SC-7(12)':
        name: 'BOUNDARY PROTECTION | HOST-BASED PROTECTION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install McAfee Agent for Windows'
      'SI-2(2)':
        name: 'FLAW REMEDIATION | AUTOMATED FLAW REMEDIATION STATUS'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Install McAfee Agent for Windows'

  splunkforwarder-windows-formula:
    targets:
      - 'Microsoft Windows Server 2012 R2'
      - 'Microsoft Windows Server 2008 R2'
    controls:
      'AU-3(1)':
        name: 'CONTENT OF AUDIT RECORDS | ADDITIONAL AUDIT INFORMATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-3(2)':
        name: 'CONTENT OF AUDIT RECORDS | CENTRALIZED MANAGEMENT OF PLANNED AUDIT RECORD CONTENT'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-4(1)':
        name: 'AUDIT STORAGE CAPACITY | TRANSFER TO ALTERNATE STORAGE'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-5(1)':
        name: 'RESPONSE TO AUDIT PROCESSING FAILURES | AUDIT STORAGE CAPACITY'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-5(2)':
        name: 'RESPONSE TO AUDIT PROCESSING FAILURES | REAL-TIME ALERTS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(1)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | PROCESS INTEGRATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(3)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | CORRELATE AUDIT REPOSITORIES'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(4)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | CENTRAL REVIEW AND ANALYSIS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(5)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | INTEGRATION / SCANNING AND MONITORING CAPABILITIES'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(6)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | CORRELATION WITH PHYSICAL MONITORING'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(7)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | PERMITTED ACTIONS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(9)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | CORRELATION WITH INFORMATION FROM NONTECHNICAL SOURCES'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-6(10)':
        name: 'AUDIT REVIEW, ANALYSIS, AND REPORTING | AUDIT LEVEL ADJUSTMENT'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-7':
        name: 'AUDIT REDUCTION AND REPORT GENERATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-7(1)':
        name: 'AUDIT REDUCTION AND REPORT GENERATION | AUTOMATIC PROCESSING'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-9':
        name: 'PROTECTION OF AUDIT INFORMATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-9(2)':
        name: 'PROTECTION OF AUDIT INFORMATION | AUDIT BACKUP ON SEPARATE PHYSICAL SYSTEMS / COMPONENTS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-9(3)':
        name: 'PROTECTION OF AUDIT INFORMATION | CRYPTOGRAPHIC PROTECTION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-9(4)':
        name: 'PROTECTION OF AUDIT INFORMATION | ACCESS BY SUBSET OF PRIVILEGED USERS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-10':
        name: 'NON-REPUDIATION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-10(1)':
        name: 'NON-REPUDIATION | ASSOCIATION OF IDENTITIES'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-10(2)':
        name: 'NON-REPUDIATION | VALIDATE BINDING OF INFORMATION PRODUCER IDENTITY'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-10(3)':
        name: 'NON-REPUDIATION | CHAIN OF CUSTODY'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-10(4)':
        name: 'NON-REPUDIATION | VALIDATE BINDING OF INFORMATION REVIEWER IDENTITY'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-11':
        name: 'AUDIT RECORD RETENTION'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-11(1)':
        name: 'AUDIT RECORD RETENTION | LONG-TERM RETRIEVAL CAPABILITY'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-12(1)':
        name: 'AUDIT GENERATION | SYSTEM-WIDE / TIME-CORRELATED AUDIT TRAIL'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'AU-12(3)':
        name: 'AUDIT GENERATION | CHANGES BY AUTHORIZED INDIVIDUALS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'CM-6':
        name: 'CONFIGURATION SETTINGS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'CM-11(1)':
        name: 'USER-INSTALLED SOFTWARE | ALERTS FOR UNAUTHORIZED INSTALLATIONS'
        type: 'Common'
        source_ref: 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'
      'MA-4(1)':
        name: 'NONLOCAL MAINTENANCE | AUDITING AND REVIEW'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install Splunk forwarder for Linux'

  windows-update-agent-formula:
    targets:
      - 'Microsoft Windows Server 2012 R2'
      - 'Microsoft Windows Server 2008 R2'
    controls:
      'CM-6':
        name: 'CONFIGURATION SETTINGS'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Establish a process to automatically install security-related software updates.'
            parameters:
              - 'HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\WUServer = [wsus-server]'
              - 'HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\WUStatusServer = [wsus-server]'
              - 'HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\AU\UseWUServer = 1'
          - action: 'Install Microsoft KB2871997'
            targets:
              - 'Microsoft Windows Server 2008 R2'

  netbanner-formula:
    targets:
      - 'Microsoft Windows Server 2012 R2'
      - 'Microsoft Windows Server 2008 R2'
    controls:
      'AC-16(5)':
        name: 'SECURITY ATTRIBUTES | ATTRIBUTE DISPLAYS FOR OUTPUT DEVICES'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install and configure Microsoft Netbanner for the security domain'
      'CM-6':
        name: 'CONFIGURATION SETTINGS'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Install and configure Microsoft Netbanner for the security domain'

  emet-formula:
    targets:
      - 'Microsoft Windows Server 2012 R2'
      - 'Microsoft Windows Server 2008 R2'
    controls:
      'CM-6':
        name: 'CONFIGURATION SETTINGS'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Install EMET v5.x or later'
      'SI-16':
        name: 'MEMORY PROTECTION'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Install EMET v5.x or later'

  ntp-client-windows-formula:
    targets:
      - 'Microsoft Windows Server 2012 R2'
      - 'Microsoft Windows Server 2008 R2'
    controls:
      'AU-8(1)':
        name: 'TIME STAMPS | SYNCHRONIZATION WITH AUTHORITATIVE TIME SOURCE'
        type: 'Common'
        source_ref:
          - 'Settings are proscribed by DISA STIG.'
        implementation:
          - action: 'Configure the registry settings'
            parameters:
              - 'HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Parameters\Type = NTP'
              - 'HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Parameters\NtpServer = [list of ntp servers]'
      'AU-12(1)':
        name: 'AUDIT GENERATION | SYSTEM-WIDE / TIME-CORRELATED AUDIT TRAIL'
        type: 'Common'
        source_ref:
          - 'NIST 800-53 rev 4'
        implementation:
          - action: 'Configure the registry settings'
            parameters:
              - 'HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Parameters\Type = NTP'
              - 'HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Parameters\NtpServer = [list of ntp servers]'
